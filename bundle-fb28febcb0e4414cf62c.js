!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);n(1)},function(t,e){const n="https://backend-dz11.herokuapp.com";let o=0,a=0,s=[];const r=document.getElementById("root"),i=document.createElement("form");i.innerHTML='\n<form>\n  <div class="form-row">\n    <div class="col-5">\n    <input class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç" data-id="link">\n    </div>\n    <input type="hidden" name="type">\n    <input type="hidden" name="url">\n    <input data-id="files" type="file" name="media">\n    <button data-id="record" class="btn btn-light">–ó–∞–ø–∏—Å—å</button>\n    <button data-id="send" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>\n  </div>\n</form>\n',r.appendChild(i);const d=document.createElement("button");d.className="btn btn-primary btn-block mt-1",d.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏",d.style.display="none",d.addEventListener("click",t=>{fetch(`${n}/posts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){o=0,s.unshift(...t.reverse()),m(f,s),d.style.display="none"})).catch(t=>{console.log(t)})}),r.appendChild(d);const c=document.querySelector("[data-id=send]"),l=i.querySelector("[data-id=link]");l.value=localStorage.getItem("content"),l.addEventListener("input",t=>{localStorage.setItem("content",t.currentTarget.value)});const u=document.querySelector("input[name=type]"),b=document.querySelector("input[name=url]"),p=document.querySelector("input[name=media]");p.addEventListener("change",t=>{t.preventDefault(),h.disabled=!0;const[e]=Array.from(t.currentTarget.files),o=new FormData;o.append("media",e),c.disabled=!0,fetch(`${n}/upload`,{method:"POST",body:o}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=`${n}/static/${t.name}`;b.value=e,u.value=t.types}).catch(t=>{console.log(t)}).finally(()=>{c.disabled=!1})});const h=i.querySelector("[data-id=record]");h.addEventListener("click",(function(t){if(t.preventDefault(),!navigator.mediaDevices){const t=document.createElement("div");return t.textContent="Your browser not support media! Use Yande Browser.",void document.body.appendChild(t)}if(!window.MediaRecorder){const t=document.createElement("div");return t.textContent="Your browser not media recordering! Use Yande Browser.",void document.body.appendChild(t)}navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(t=>{c.disabled=!0,p.disabled=!0;const e=new MediaRecorder(t,{mediaType:"video/webm"}),o=[];e.addEventListener("dataavailable",t=>{o.push(t.data)}),e.addEventListener("stop",e=>{t.getTracks().forEach(t=>t.stop());const a=new Blob(o),s=new FormData;s.append("media",a),fetch(`${n}/upload`,{method:"POST",body:s}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=`${n}/static/${t.name}`;b.value=e,u.value=t.types,c.disabled=!1}).catch(t=>{console.log(t)})}),e.start(),setTimeout(()=>{e.stop()},1e4)}).catch(t=>{console.log(t)})})),i.querySelector("[data-id=send]").addEventListener("click",(function(t){t.preventDefault();const e={id:0,content:l.value,type:u.value,file:b.value};fetch(`${n}/posts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{console.log(t),l.value="",u.value="",b.value="",p.value="",p.disabled=!1,h.disabled=!1,localStorage.clear(),s.unshift(t),o=t.id,m(f,s)}).catch(t=>{console.log(t)})}));const f=document.createElement("div");function m(t,e){console.log(s);for(const a of e){const e=document.createElement("div");e.className="card mb-2",e.innerHTML=""===(o=a).type?`\n        <div class="card-body">\n            <div class="card-text">${o.content}</div>\n            <button class="btn">‚ô° ${o.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:"image"===o.type?`\n        <img src="${o.file}" class="card-img-top"></img>\n        <div class="card-body">\n            <p style='font-size:20px'>${o.content}</p>\n            <button class="btn">‚ô° ${o.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:"audio"===o.type?`\n        <audio src="${o.file}" class="card-img-top" controls></audio>\n        <div class="card-body">\n            <p style='font-size:20px'>${o.content}</p>\n            <button class="btn">‚ô° ${o.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:"video"===o.type?`\n        <video src="${o.file}" width="960" height="540" class="embed-responsive embed-responsive-16by9 card-img-top" controls></video>\n        <div class="card-body">\n            <p style='font-size:20px'>${o.content}</p>\n            <button class="btn">‚ô° ${o.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:void 0,e.querySelector("[data-action=delete]").addEventListener("click",(function(){fetch(`${n}/posts/${a.id}`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=s.findIndex(t=>t.id===a.id);s.splice(e,1),m(f,s)}).catch(t=>{console.log(t)})})),e.querySelector("[data-action=like]").addEventListener("click",(function(t){t.preventDefault(),fetch(`${n}/posts/${a.id}/likes`,{method:"POST"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=s.findIndex(t=>t.id===a.id);s[e].likes++,m(f,s)}).catch(t=>{console.log(t)})})),e.querySelector("[data-action=dislike]").addEventListener("click",(function(t){t.preventDefault(),fetch(`${n}/posts/${a.id}/likes`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=s.findIndex(t=>t.id===a.id);s[e].likes--,m(f,s)}).catch(t=>{console.log(t)})})),t.appendChild(e)}var o}r.appendChild(f),fetch(`${n}/posts/seenPosts/${a}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0!==t.length&&(t.length<5?s.push(...t.reverse()):(a=t[t.length-5].id,s.push(...t.reverse()),y.style.display="block"),m(f,s))})).catch(t=>{console.log(t)});const y=document.createElement("button");y.className="btn btn-primary btn-block mt-1",y.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ –ø–æ—Å—Ç—ã",y.style.display="none",y.addEventListener("click",(function(){fetch(`${n}/posts/seenPosts/${a}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?y.style.display="none":(t.length<5?(a=t[t.length-1].id,s.push(...t.reverse()),y.style.display="none"):(a=t[t.length-5].id,s.push(...t.reverse()),y.style.display="block"),m(f,s))})).catch(t=>{console.log(t)})})),r.appendChild(y),setInterval(()=>{fetch(`${n}/posts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?(console.log("–ù–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –Ω–µ—Ç"),d.style.display="none"):0===o?(o=t[t.length-1].id,d.style.display="none"):d.style.display="block"})).catch(t=>{console.log(t)})},3e3)}]);