!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);n(1)},function(t,e){const n="https://backend-dz11.herokuapp.com";let o=0,a=0;const r=document.getElementById("root"),i=document.createElement("form");i.innerHTML='\n<form>\n  <div class="form-row">\n    <div class="col-5">\n    <input class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç" data-id="link">\n    </div>\n    <input type="hidden" name="type">\n    <input type="hidden" name="url">\n    <input data-id="files" type="file" name="media">\n    <button data-id="record" class="btn btn-light">–ó–∞–ø–∏—Å—å</button>\n    <button data-id="send" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>\n  </div>\n</form>\n',r.appendChild(i);const s=document.createElement("button");s.className="btn btn-primary btn-block mt-1",s.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏",s.style.display="none",s.addEventListener("click",t=>{t.preventDefault(),fetch(`${n}/posts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){o=0,f(h,t,1),s.style.display="none"})).catch(t=>{console.log(t)})}),r.appendChild(s);const d=document.querySelector("[data-id=send]"),l=i.querySelector("[data-id=link]");l.value=localStorage.getItem("content"),l.addEventListener("input",t=>{localStorage.setItem("content",t.currentTarget.value)});const c=document.querySelector("input[name=type]"),u=document.querySelector("input[name=url]"),b=document.querySelector("input[name=media]");b.addEventListener("change",t=>{t.preventDefault(),p.disabled=!0;const[e]=Array.from(t.currentTarget.files),o=new FormData;o.append("media",e),d.disabled=!0,fetch(`${n}/upload`,{method:"POST",body:o}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=`${n}/static/${t.name}`;u.value=e,c.value=t.types}).catch(t=>{console.log(t)}).finally(()=>{d.disabled=!1})});const p=i.querySelector("[data-id=record]");p.addEventListener("click",(function(t){if(t.preventDefault(),!navigator.mediaDevices){const t=document.createElement("div");return t.textContent="Your browser not support media! Use Yande Browser.",void document.body.appendChild(t)}if(!window.MediaRecorder){const t=document.createElement("div");return t.textContent="Your browser not media recordering! Use Yande Browser.",void document.body.appendChild(t)}navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(t=>{d.disabled=!0,b.disabled=!0;const e=new MediaRecorder(t,{mediaType:"video/webm"}),o=[];e.addEventListener("dataavailable",t=>{o.push(t.data)}),e.addEventListener("stop",e=>{t.getTracks().forEach(t=>t.stop());const a=new Blob(o),r=new FormData;r.append("media",a),fetch(`${n}/upload`,{method:"POST",body:r}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const e=`${n}/static/${t.name}`;u.value=e,c.value=t.types,d.disabled=!1}).catch(t=>{console.log(t)})}),e.start(),setTimeout(()=>{e.stop()},1e4)}).catch(t=>{console.log(t)})})),i.querySelector("[data-id=send]").addEventListener("click",(function(t){t.preventDefault();const e={id:0,content:l.value,type:c.value,file:u.value};fetch(`${n}/posts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{l.value="",c.value="",u.value="",b.value="",b.disabled=!1,p.disabled=!1,localStorage.clear(),o=t.id,f(h,Array(t),1)}).catch(t=>{console.log(t)})}));const h=document.createElement("div");function f(t,e,o){for(let r of e){const e=document.createElement("li");e.className="card mb-2",e.innerHTML=""===(a=r).type?`\n        <div class="card-body">\n            <div class="card-text">${a.content}</div>\n            <button class="btn" data-id="likes">‚ô° ${a.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n            <button>${a.id}\n        </div>\n    `:"image"===a.type?`\n        <img src="${a.file}" class="card-img-top"></img>\n        <div class="card-body">\n            <p style='font-size:20px'>${a.content}</p>\n            <button class="btn" data-id="likes">‚ô° ${a.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:"audio"===a.type?`\n        <audio src="${a.file}" class="card-img-top" controls></audio>\n        <div class="card-body">\n            <p style='font-size:20px'>${a.content}</p>\n            <button class="btn" data-id="likes">‚ô° ${a.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:"video"===a.type?`\n        <video src="${a.file}" width="960" height="540" class="embed-responsive embed-responsive-16by9 card-img-top" controls></video>\n        <div class="card-body">\n            <p style='font-size:20px'>${a.content}</p>\n            <button class="btn" data-id="likes">‚ô° ${a.likes}</button>\n            <button class="btn btn-primary" data-action="like">üëç</button>\n            <button class="btn btn-danger" data-action="dislike">üëé</button>\n            <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n        </div>\n    `:void 0,e.querySelector("[data-action=delete]").addEventListener("click",(function(){fetch(`${n}/posts/${r.id}`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(n=>{t.removeChild(e)}).catch(t=>{console.log(t)})})),e.querySelector("[data-action=like]").addEventListener("click",(function(t){t.preventDefault(),fetch(`${n}/posts/${r.id}/likes`,{method:"POST"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{e.querySelector("[data-id=likes]").textContent=`‚ô° ${t.likes}`}).catch(t=>{console.log(t)})})),e.querySelector("[data-action=dislike]").addEventListener("click",(function(t){t.preventDefault(),fetch(`${n}/posts/${r.id}/likes`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{e.querySelector("[data-id=likes]").textContent=`‚ô° ${t.likes}`}).catch(t=>{console.log(t)})})),1===o?t.insertBefore(e,t.firstElementChild):t.appendChild(e)}var a}r.appendChild(h),fetch(`${n}/posts/seenPosts/${a}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0!==t.length&&(t.length>=5&&(a=t[t.length-5].id,m.style.display="block"),f(h,t.reverse()))})).catch(t=>{console.log(t)});const m=document.createElement("button");m.className="btn btn-primary btn-block mt-1",m.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ –ø–æ—Å—Ç—ã",m.style.display="none",m.addEventListener("click",(function(t){t.preventDefault(),fetch(`${n}/posts/seenPosts/${a}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?m.style.display="none":(t.length<5?(a=t[t.length-1].id,m.style.display="none"):(a=t[t.length-5].id,m.style.display="block"),f(h,t.reverse()))})).catch(t=>{console.log(t)})})),r.appendChild(m),setInterval(()=>{fetch(`${n}/posts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?(console.log("–ù–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –Ω–µ—Ç"),s.style.display="none"):0===o?(o=t[t.length-1].id,s.style.display="none"):s.style.display="block"})).catch(t=>{console.log(t)})},3e3)}]);